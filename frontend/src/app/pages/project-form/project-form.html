<div class="form-page">
  <header class="form-header">
    <h1>{{ isEdit() ? 'Editar projeto' : 'Novo projeto' }}</h1>
    <nav class="nav-menu">
      <a routerLink="/dashboard" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">Dashboard</a>
      <a routerLink="/projetos" routerLinkActive="active">Projetos</a>
      <a routerLink="/recursos" routerLinkActive="active">Recursos</a>
    </nav>
    <div class="user-bar">
      <span class="user-email">{{ email }}</span>
      <a routerLink="/login" (click)="logout()" class="btn-logout">Sair</a>
    </div>
  </header>

  @if (loading()) {
    <p class="loading">Carregando…</p>
  } @else {
    <form class="form-card" (ngSubmit)="onSubmit()">
      @if (error()) {
        <p class="form-error">{{ error() }}</p>
      }
      <div class="form-group">
        <label for="name">Nome *</label>
        <input
          id="name"
          type="text"
          [ngModel]="name()"
          (ngModelChange)="name.set($event)"
          name="name"
          required
          maxlength="255"
          placeholder="Nome do projeto"
        />
      </div>
      <div class="form-group">
        <label for="description">Descrição</label>
        <textarea
          id="description"
          [ngModel]="description()"
          (ngModelChange)="description.set($event)"
          name="description"
          rows="3"
          maxlength="2000"
          placeholder="Descrição (opcional)"
        ></textarea>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label for="start_date">Data de início *</label>
          <input
            id="start_date"
            type="date"
            [ngModel]="startDate()"
            (ngModelChange)="startDate.set($event)"
            name="start_date"
            required
          />
        </div>
        <div class="form-group">
          <label for="end_date">Data de fim *</label>
          <input
            id="end_date"
            type="date"
            [ngModel]="endDate()"
            (ngModelChange)="endDate.set($event)"
            name="end_date"
            required
          />
        </div>
      </div>
      <div class="form-group">
        <label for="status">Status</label>
        <select
          id="status"
          [ngModel]="status()"
          (ngModelChange)="status.set($event)"
          name="status"
        >
          @for (opt of statusOptions; track opt.value) {
            <option [value]="opt.value">{{ opt.label }}</option>
          }
        </select>
      </div>
      <div class="form-actions">
        <button type="button" class="btn-cancel" routerLink="/projetos">Cancelar</button>
        <button type="submit" class="btn-submit" [disabled]="saving()">
          {{ saving() ? 'Salvando…' : (isEdit() ? 'Salvar' : 'Cadastrar') }}
        </button>
      </div>
    </form>
  }
</div>
